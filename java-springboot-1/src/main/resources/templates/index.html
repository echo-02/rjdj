
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>Home</title>
		<meta name="description" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="robots" content="all,follow">
		<!-- Bootstrap CSS-->
		<link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">
		<!-- Font Awesome CSS-->
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU"
		 crossorigin="anonymous">
		<!-- Google fonts - Popppins for copy-->
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,800">
		<!-- orion icons-->
		<link rel="stylesheet" href="css/orionicons.css">
		<!-- theme stylesheet-->
		<link rel="stylesheet" href="css/style.default.css" id="theme-stylesheet">
		<!-- Custom stylesheet - for your changes-->
		<link rel="stylesheet" href="css/custom.css">
		<!-- Favicon-->
		<link rel="shortcut icon" href="img/favicon.png?3">
		<link rel="stylesheet" type="text/css" href="css/user.css"/>
		<!-- Tweaks for older IEs-->
		<!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
	</head>
	<body>
		<!-- 头部-->
		<header class="header">
			<nav class="navbar navbar-expand-lg px-4 py-2 bg-white shadow">
				<a href="#" class="sidebar-toggler text-gray-500 mr-4 mr-lg-5 lead">
					<i class="fas fa-align-left"></i>
				</a>
				<a href="index.html" class="navbar-brand font-weight-bold text-uppercase text-base">日进斗金管理系统</a>
				<ul class="ml-auto d-flex align-items-center list-unstyled mb-0">
					<li class="nav-item dropdown ml-auto"><a id="userInfo" href="http://example.com" data-toggle="dropdown"
						 aria-haspopup="true" aria-expanded="false" class="nav-link dropdown-toggle"><img  alt="Jason Doe"
							 style="max-width: 2.5rem;" class="img-fluid rounded-circle shadow"><span name="account"></span></a>
						<div aria-labelledby="userInfo" class="dropdown-menu"><a href="#" class="dropdown-item"><strong class="d-block text-uppercase headings-font-family">Mark
									Stephen</strong><small>Web Developer</small></a>
							<div class="dropdown-divider"></div><a href="#" class="dropdown-item">Settings</a><a href="#" class="dropdown-item">Activity
								log </a>
							<div class="dropdown-divider"></div><a href="login.html" class="dropdown-item">Logout</a>
						</div>
					</li>
				</ul>
			</nav>
		</header>
		<!-- 左侧导航栏 -->
		<div class="d-flex align-items-stretch">
			<div id="sidebar" class="sidebar py-3">
				<div class="text-gray-400 text-uppercase px-3 px-lg-4 py-4 font-weight-bold small headings-font-family">MAIN</div>
				<ul class="sidebar-menu list-unstyled">
					<li class="sidebar-list-item "><a th:href="@{/index}" class="sidebar-link text-muted active"><i class="o-home-1 mr-3 text-gray"></i><span>用户信息</span></a></li>
					<li class="sidebar-list-item "><a th:href="@{/collect}" class="sidebar-link text-muted"><i class="o-sales-up-1 mr-3 text-gray"></i><span>收银</span></a></li>
					<li class="sidebar-list-item">
						<a href="javascript:void(0)" data-toggle="collapse" data-target="#shop" aria-expanded="false" aria-controls="shop"
						 class="sidebar-link text-muted">
							<i class="o-wireframe-1 mr-3 text-gray"></i><span>店铺</span>
						</a>
						<div id="shop" class="collapse">
							<ul class="sidebar-menu list-unstyled border-left border-primary border-thick">
								<li class="sidebar-list-item"><a th:href="@{/shopManagement}" class="sidebar-link text-muted pl-lg-5">店铺管理</a></li>
								<li class="sidebar-list-item"><a th:href="@{/positionAuthority}" class="sidebar-link text-muted pl-lg-5">职位权限</a></li>
								<li class="sidebar-list-item"><a th:href="@{/authorityManagement}" class="sidebar-link text-muted pl-lg-5">权限管理</a></li>
								<li class="sidebar-list-item"><a th:href="@{/staffManagement}" class="sidebar-link text-muted pl-lg-5">员工管理</a></li>
							</ul>
						</div>
					</li>
					<li class="sidebar-list-item">
						<a href="javascript:void(0)" data-toggle="collapse" data-target="#pro" aria-expanded="false" aria-controls="pro"
						 class="sidebar-link text-muted">
							<i class="o-wireframe-1 mr-3 text-gray"></i><span>商品</span>
						</a>
						<div id="pro" class="collapse">
							<ul class="sidebar-menu list-unstyled border-left border-primary border-thick">
								<li class="sidebar-list-item"><a th:href="@{/proType}" class="sidebar-link text-muted pl-lg-5">商品类别</a></li>
								<li class="sidebar-list-item"><a th:href="@{/proManagement}" class="sidebar-link text-muted pl-lg-5">商品管理</a></li>
								<li class="sidebar-list-item"><a th:href="@{/proUploading}" class="sidebar-link text-muted pl-lg-5">商品上传</a></li>
								<li class="sidebar-list-item"><a th:href="@{/supplier}" class="sidebar-link text-muted pl-lg-5">供应商</a></li>
								<li class="sidebar-list-item"><a th:href="@{/purchase}" class="sidebar-link text-muted pl-lg-5">采购单</a></li>
							</ul>
						</div>
					</li>
					<li class="sidebar-list-item">
						<a href="javascript:void(0)" data-toggle="collapse" data-target="#vip" aria-expanded="false" aria-controls="vip"
						 class="sidebar-link text-muted">
							<i class="o-wireframe-1 mr-3 text-gray"></i><span>会员</span>
						</a>
						<div id="vip" class="collapse">
							<ul class="sidebar-menu list-unstyled border-left border-primary border-thick">
								<li class="sidebar-list-item"><a th:href="@{/vipInfo}" class="sidebar-link text-muted pl-lg-5">会员信息</a></li>
								<li class="sidebar-list-item"><a th:href="@{/levelSetting}" class="sidebar-link text-muted pl-lg-5">等级设置</a></li>
								<li class="sidebar-list-item"><a th:href="@{/integralSetting}" class="sidebar-link text-muted pl-lg-5">积分设置</a></li>
								<li class="sidebar-list-item"><a th:href="@{/chargingOffset}" class="sidebar-link text-muted pl-lg-5">充值抵扣</a></li>
								<li class="sidebar-list-item"><a th:href="@{/transactionRecord}" class="sidebar-link text-muted pl-lg-5">成交记录</a></li>
							</ul>
						</div>
					</li>
					<li class="sidebar-list-item"><a th:href="@{/login}" class="sidebar-link text-muted"><i class="o-exit-1 mr-3 text-gray"></i><span>注销</span></a></li>
				</ul>
			</div>
			<!-- 右侧主体 -->
			<div class="page-holder w-100 d-flex flex-wrap">
				<div class="container-fluid px-xl-5">
					<!-- 自己的页面内容 -->
					<div class="userinfo">
						<span>用户信息</span>
						<hr />
					</div>
					
					
					<div class="user-content" id="userContent">
						<!--<img src="" style="width: 220px;height: 220px;border-radius: 5px;"/>-->
						<div class="user-img" style="margin:-30px 0 0 0 ">
							<img  style="width: 220px;height: 220px;" class="img-thumbnail" id="img">
							<!-- <p style="margin-left:-47px ;"><input multiple name="files" type="file" ></p>
							<p onclick="upLoad()" style="cursor: pointer; margin: -10px 0 0 53px;">上传头像</p> -->
							<form th:action="@{/upload}" method="post" enctype="multipart/form-data">
								<p style="font: 16px '微软雅黑';"><input multiple name="files" type="file"></p>
								<input style="font: 16px '微软雅黑';" type="button" value="修改头像" class="btn btn-default">
							</form>
						</div>
						<div class="user-content-i" style="margin:-30px 0 0 0;position: relative;left:-60px;">
							<p>用户信息</p>
							<p>行业：<input name="trade" type="text" class="form-control-label" style="height: 30px;width: 200px;"/></p>
							<p>账号：<input name="username" type="text" class="form-control-label" style="height: 30px;width: 200px;"/></p>
							<p>手机：<input name="phone" type="text" class="form-control-label" style="height: 30px;width: 200px;"/></p>
							<p>密码：<input name="password" type="password" class="form-control-label" style="height: 30px;width: 200px;"/><button class="btn btn-success" style="height:30px ;line-height: 8px; margin-left: 10px;" onclick="updateUser()">修改</button></p>	
						</div>
					</div>



				</div>
				<footer class="footer bg-white shadow align-self-end py-3 px-xl-5 w-100">
					<div class="container-fluid">
						<div class="row">
							<div class="col-md-6 text-center text-md-left text-primary">
								<p class="mb-2 mb-md-0"></p>
								
							</div>
							<div class="col-md-6 text-center text-md-right text-gray-400"></div>
						</div>
					</div>
				</footer>
			</div>
		</div>
		<!-- JavaScript files-->
		<script src="vendor/jquery/jquery.min.js"></script>
		<script src="vendor/popper.js/umd/popper.min.js"> </script>
		<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
		<script src="vendor/jquery.cookie/jquery.cookie.js"> </script>
		<script src="vendor/chart.js/Chart.min.js"></script>
		<script src="js/js.cookie.min.js"></script>
		<script src="js/charts-home.js"></script>
		<script src="js/front.js"></script>
		<script type="text/javascript" th:src="@{/js/jquery-1.12.4.js}"></script>
		<script type="text/javascript" th:src="@{/js/vue.js}"></script>
		<script type="text/javascript">
		   var ctxPath = "[[@{/}]]";
		   $(function(){
			    byid();
		   })
		   function updateUser(){
			   var trade=$("[name='trade']").val();
			   var username=$("[name='username']").val();
			   var phone=$("[name='phone']").val();
			   var password=$("[name='password']").val();
			   
			   $.ajax({
				   url:"[[@{/user/updateUser}]]",
				   data:{
					   userid:"[[${session.user.userid}]]",
					   trade:trade,
					   username:username,
					   phone:phone,
					   password:password,   
				   },
				   success:function(res){
					  byid();
				   }
			   })
		   }
		   
		   function byid(){
			   $.ajax({
				   url:"[[@{/user/byUserId}]]",
				   data:{
					   userid:"[[${session.user.userid}]]"
				   },
				   success:function(res){
					   console.info(res)
					   $("img").attr("src",ctxPath+"images/"+res.userpic)
					   $("[name='trade']").attr("value",res.trade);
					   $("[name='username']").attr("value",res.username);
					   $("[name='phone']").attr("value",res.phone);
					   $("[name='password']").attr("value",res.password);
				   }
			   });
		   }
		   
		   
		  $(function(){  
			$("[type=button]").click(function(){
				var formData = new FormData($("form")[0]);
				/* var files = $("[name=files]")[0].files;
				for(var i=0;i<files.length;i++){
					formData.append("files",files[i]);
				} */
				console.log(formData);
				
				$.ajax({
					url:"[[@{/user/uploadAjax}]]",
					data:formData,
					type:"post",
					processData:false,
					contentType:false,
					success:function(result){
						byid();
					}
				});
			});			
		})
		</script>
		
	</body>
</html>
